(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{SnmA:function(t,e,r){"use strict";r.r(e),r.d(e,"GroupModule",function(){return it});var i=r("ofXK"),o=r("tyNb"),a=r("auXs"),s=r("M9IT"),c=r("Dh3D"),n=r("+0xr"),l=r("WQoS"),b=r("fXoL"),u=r("m86e"),d=r("lGQG"),p=r("W/PH"),m=r("uQ6V"),h=r("kmnG"),g=r("qFsG"),f=r("bTqV"),y=r("Qu3c"),v=r("NFeN");function D(t,e){1&t&&(b.Rb(0,"th",22),b.yc(1," Code "),b.Qb())}function S(t,e){if(1&t&&(b.Rb(0,"td",23),b.yc(1),b.Qb()),2&t){const t=e.$implicit;b.Ab(1),b.zc(t.code)}}function R(t,e){1&t&&(b.Rb(0,"th",22),b.yc(1," Name "),b.Qb())}function w(t,e){if(1&t&&(b.Rb(0,"td",23),b.yc(1),b.Qb()),2&t){const t=e.$implicit;b.Ab(1),b.zc(t.name)}}function A(t,e){1&t&&(b.Rb(0,"th",22),b.yc(1," Type "),b.Qb())}function Q(t,e){if(1&t&&(b.Rb(0,"td",23),b.yc(1),b.Qb()),2&t){const t=e.$implicit;b.Ab(1),b.zc(t.groupName)}}function C(t,e){1&t&&(b.Rb(0,"th",24),b.yc(1," Operations "),b.Qb())}function x(t,e){if(1&t){const t=b.Sb();b.Rb(0,"button",28),b.Yb("click",function(){b.oc(t);const e=b.cc().$implicit;return b.cc().edit(e)}),b.Rb(1,"mat-icon"),b.yc(2,"edit"),b.Qb(),b.Qb()}}function E(t,e){if(1&t){const t=b.Sb();b.Rb(0,"button",29),b.Yb("click",function(){b.oc(t);const e=b.cc().$implicit;return b.cc().delete(e)}),b.Rb(1,"mat-icon"),b.yc(2,"delete"),b.Qb(),b.Qb()}}function L(t,e){if(1&t&&(b.Rb(0,"td",25),b.wc(1,x,3,0,"button",26),b.wc(2,E,3,0,"button",27),b.Qb()),2&t){const t=b.cc();b.Ab(1),b.ic("ngIf",t.userPersmissions.editGroup),b.Ab(1),b.ic("ngIf",t.userPersmissions.deleteGroup)}}function T(t,e){if(1&t&&(b.Rb(0,"td",30),b.yc(1," No Data Available "),b.Qb()),2&t){const t=b.cc();b.Bb("colspan",t.columnsToDisplay.length)}}function M(t,e){1&t&&b.Mb(0,"tr",31)}function P(t,e){1&t&&b.Mb(0,"tr",32)}function O(t,e){if(1&t&&b.Mb(0,"tr",33),2&t){const t=b.cc();b.ic("hidden",!(0===t.groupListDS.filteredData.length))}}const k=function(){return["noData"]},F=function(){return[5,10,15,20,25]};let I=(()=>{class t{constructor(t,e,r,i,o,a){this.grpSrvc=t,this.authSrvc=e,this.alrtSrvc=r,this.exportSrvc=i,this.router=o,this.route=a,this.groupType=l.c,this.exportColumns=["code","name","groupName"],this.columnsToDisplay=["code","name","groupName"],this.userPersmissions=null}ngOnInit(){this.userPersmissions=this.authSrvc.userPersmissions,(this.userPersmissions.editGroup||this.userPersmissions.deleteGroup)&&this.columnsToDisplay.push("oprts"),this.groupListDS=new n.o,this.refresh(),this.groupListUpdateSubscription=this.grpSrvc.listUpdate$.subscribe(()=>{this.refresh()})}ngAfterViewInit(){this.groupListDS.paginator=this.paginator,this.groupListDS.sort=this.sort}ngOnDestroy(){this.groupListUpdateSubscription.unsubscribe()}applyFilter(t){this.groupListDS.filter=t}trackList(t,e){return e._id}refresh(){this.grpSrvc.getList().subscribe(t=>{this.groupListDS.data=this.formatData(t)},t=>{this.alrtSrvc.showErrorAlert(t)})}formatData(t){return t.length>0&&t.forEach(t=>t.groupName=Object(l.d)(t.grpType)),t}edit(t){this.router.navigate([{outlets:{dialog:["dialog","group","edit",t._id]}}],{relativeTo:this.route.root,skipLocationChange:!0})}delete(t){this.alrtSrvc.showConfirmAlert("Do you want to delete "+t.code).afterClosed().subscribe(e=>{e&&this.grpSrvc.delete(t._id).subscribe(t=>{this.refresh()},t=>{this.alrtSrvc.showErrorAlert(t)})})}exportData(){const t=this.authSrvc.user.username+"_group_"+Date.now(),e=[].concat({code:"Code",name:"Name",groupName:"Type"}).concat(this.groupListDS.filteredData);this.exportSrvc.exportAsExcelFile(e,t,{filterKeys:this.exportColumns,skipHeader:!0})}}return t.\u0275fac=function(e){return new(e||t)(b.Lb(u.a),b.Lb(d.a),b.Lb(p.b),b.Lb(m.a),b.Lb(o.b),b.Lb(o.a))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-groups-list"]],viewQuery:function(t,e){if(1&t&&(b.Dc(s.a,!0),b.Dc(c.a,!0)),2&t){let t;b.lc(t=b.Zb())&&(e.paginator=t.first),b.lc(t=b.Zb())&&(e.sort=t.first)}},decls:35,vars:10,consts:[[1,"flex-space","align-left"],[1,"mat-title","mr-05"],[1,"space-7","mr-05"],["matInput","","type","text",3,"keyup"],["type","button","mat-mini-fab","","color","primary","matTooltip","Refresh List",3,"click"],["type","button","mat-mini-fab","","color","primary","matTooltip","Download List",3,"disabled","click"],[1,"container","mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource","trackBy"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","groupName"],["matColumnDef","oprts"],["mat-header-cell","","data-export","false",4,"matHeaderCellDef"],["mat-cell","","data-export","false",4,"matCellDef"],["matColumnDef","noData"],["mat-footer-cell","","data-export","false",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","data-export","false","style","text-align: center;",3,"hidden",4,"matFooterRowDef"],["pageSize","10","showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","data-export","false"],["mat-cell","","data-export","false"],["type","button","mat-icon-button","","matTooltip","Edit",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Delete",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Edit",3,"click"],["type","button","mat-icon-button","","matTooltip","Delete",3,"click"],["mat-footer-cell","","data-export","false"],["mat-header-row",""],["mat-row",""],["mat-footer-row","","data-export","false",2,"text-align","center",3,"hidden"]],template:function(t,e){1&t&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.yc(2," Group List "),b.Qb(),b.Rb(3,"mat-form-field",2),b.Rb(4,"mat-label"),b.yc(5,"Filter"),b.Qb(),b.Rb(6,"input",3),b.Yb("keyup",function(t){return e.applyFilter(t.target.value)}),b.Qb(),b.Qb(),b.Rb(7,"div"),b.Rb(8,"button",4),b.Yb("click",function(){return e.refresh()}),b.Rb(9,"mat-icon"),b.yc(10,"refresh"),b.Qb(),b.Qb(),b.yc(11," \xa0 "),b.Rb(12,"button",5),b.Yb("click",function(){return e.exportData()}),b.Rb(13,"mat-icon"),b.yc(14,"save_alt"),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(15,"div",6),b.Rb(16,"table",7),b.Pb(17,8),b.wc(18,D,2,0,"th",9),b.wc(19,S,2,1,"td",10),b.Ob(),b.Pb(20,11),b.wc(21,R,2,0,"th",9),b.wc(22,w,2,1,"td",10),b.Ob(),b.Pb(23,12),b.wc(24,A,2,0,"th",9),b.wc(25,Q,2,1,"td",10),b.Ob(),b.Pb(26,13),b.wc(27,C,2,0,"th",14),b.wc(28,L,3,2,"td",15),b.Ob(),b.Pb(29,16),b.wc(30,T,2,1,"td",17),b.Ob(),b.wc(31,M,1,0,"tr",18),b.wc(32,P,1,0,"tr",19),b.wc(33,O,1,1,"tr",20),b.Qb(),b.Mb(34,"mat-paginator",21),b.Qb()),2&t&&(b.Ab(12),b.ic("disabled",0===e.groupListDS.filteredData.length),b.Ab(4),b.ic("dataSource",e.groupListDS)("trackBy",e.trackList),b.Ab(15),b.ic("matHeaderRowDef",e.columnsToDisplay)("matHeaderRowDefSticky",!0),b.Ab(1),b.ic("matRowDefColumns",e.columnsToDisplay),b.Ab(1),b.ic("matFooterRowDef",b.jc(8,k)),b.Ab(1),b.ic("pageSizeOptions",b.jc(9,F)))},directives:[h.c,h.g,g.a,f.a,y.a,v.a,n.n,c.a,n.c,n.i,n.b,n.e,n.k,n.m,n.g,s.a,n.h,c.b,n.a,i.l,n.d,n.j,n.l,n.f],styles:[".mat-icon-button[_ngcontent-%COMP%]{width:30px;height:30px;line-height:30px}"]}),t})();var G=r("3Pt+"),_=r("0IaG"),N=r("PqYM"),j=r("LRne"),q=r("eIep"),H=r("lJxs"),B=r("JIr8"),U=r("U7T7"),z=r("o0su"),V=r("d3UM"),Y=r("FKr1"),$=r("Xa2L");function J(t,e){1&t&&b.Mb(0,"mat-spinner",17)}function X(t,e){if(1&t&&(b.Rb(0,"mat-error"),b.yc(1),b.Qb()),2&t){const t=b.cc();b.Ab(1),b.Ac(" ",t.code.hasError("alreadyExists")?"Code already exists":"Enter code"," ")}}function K(t,e){1&t&&(b.Rb(0,"mat-error"),b.yc(1," Enter name "),b.Qb())}let W=(()=>{class t{constructor(t,e,r,i,o,a){this.fb=t,this.dispSrvc=e,this.grpSrvc=r,this.alrtSrvc=i,this.dialogRef=o,this.data=a,this.groupType=l.c,this.pageMode="",this.isCreateMode=!1,this.inProgress=!1,this.isSmallScrn=!1}ngOnInit(){this.isSmallScrnSubscription=this.dispSrvc.isHandSet$.subscribe(t=>{this.isSmallScrn=t},t=>{}),this.pageMode=U.a.PageModeMapping(this.data.pageMode),this.data.pageMode===U.a.PAGE_MODE.CREATE&&(this.isCreateMode=!0),this.groupDtlsForm=this.fb.group({_id:[""],code:["",{validators:[G.w.required,G.w.maxLength(10)],asyncValidators:this.isCreateMode?[this.isCodeUnique()]:[]}],name:["",[G.w.required,G.w.maxLength(50)]],grpType:[this.groupType.Trading,[G.w.required]]}),this.isCreateMode||this.groupDtlsForm.patchValue(this.data.details)}ngOnDestroy(){this.isSmallScrnSubscription.unsubscribe()}get code(){return this.groupDtlsForm.get("code")}get name(){return this.groupDtlsForm.get("name")}get grpType(){return this.groupDtlsForm.get("grpType")}save(){if(!this.groupDtlsForm.valid)return!1;this.isCreateMode?this.createGroup():this.editGroup()}createGroup(){this.inProgress=!0;const t=Object.assign({},this.groupDtlsForm.value);delete t._id,this.grpSrvc.save(t).subscribe(t=>{this.inProgress=!1,this.alrtSrvc.showSuccessAlert(t).afterClosed().subscribe(()=>{this.dialogRef.close(),this.grpSrvc.notifyToUpdateList()})},t=>{this.inProgress=!1,t.includes("already exists")?this.code.setErrors({alreadyExists:!0}):this.alrtSrvc.showErrorAlert(t)})}editGroup(){this.inProgress=!0;const t=Object.assign({},this.groupDtlsForm.value),e=t._id;delete t._id,this.grpSrvc.update(e,t).subscribe(t=>{this.inProgress=!1,this.alrtSrvc.showSuccessAlert(t).afterClosed().subscribe(()=>{this.dialogRef.close(),this.grpSrvc.notifyToUpdateList()})},t=>{this.inProgress=!1,this.alrtSrvc.showErrorAlert(t)})}isCodeUnique(){return t=>Object(N.a)(500).pipe(Object(q.a)(()=>this.grpSrvc.isCodeAvail(t.value)),Object(H.a)(t=>t?null:{alreadyExists:!0}),Object(B.a)(()=>Object(j.a)(null)))}}return t.\u0275fac=function(e){return new(e||t)(b.Lb(G.e),b.Lb(z.c),b.Lb(z.g),b.Lb(p.b),b.Lb(_.g),b.Lb(_.a))},t.\u0275cmp=b.Fb({type:t,selectors:[["ng-component"]],decls:44,vars:20,consts:[[3,"formGroup","ngSubmit"],["mat-dialog-title","",1,"flex-title"],["mat-dialog-close",""],["type","button","mat-icon-button","","isIconButton","true","aria-label","close dialog","tabindex","-1"],["mat-dialog-content",""],[1,"flex-space"],[1,"space-full"],["type","text","matInput","","formControlName","code","maxlength","10","required","","uppercase","",3,"readonly"],["mode","indeterminate","diameter","20","matSuffix","",4,"ngIf"],["align","end"],[4,"ngIf"],["type","text","matInput","","formControlName","name","maxlength","50","required","","uppercase",""],["formControlName","grpType","required",""],[3,"value"],["mat-dialog-actions","","align","end"],["type","submit","mat-raised-button","","color","primary",2,"font-weight","bold",3,"disabled"],["type","button","mat-stroked-button","","mat-dialog-close","","color","primary",2,"font-weight","bold"],["mode","indeterminate","diameter","20","matSuffix",""]],template:function(t,e){1&t&&(b.Rb(0,"form",0),b.Yb("ngSubmit",function(){return e.save()}),b.Rb(1,"div",1),b.Rb(2,"div"),b.yc(3),b.Qb(),b.Rb(4,"div",2),b.Rb(5,"button",3),b.Rb(6,"mat-icon"),b.yc(7,"close"),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(8,"div",4),b.Rb(9,"div",5),b.Rb(10,"mat-form-field",6),b.Rb(11,"mat-label"),b.yc(12,"Code"),b.Qb(),b.Mb(13,"input",7),b.wc(14,J,1,0,"mat-spinner",8),b.Rb(15,"mat-hint",9),b.yc(16),b.Qb(),b.wc(17,X,2,1,"mat-error",10),b.Qb(),b.Qb(),b.Rb(18,"div",5),b.Rb(19,"mat-form-field",6),b.Rb(20,"mat-label"),b.yc(21,"Name"),b.Qb(),b.Mb(22,"input",11),b.Rb(23,"mat-hint",9),b.yc(24),b.Qb(),b.wc(25,K,2,0,"mat-error",10),b.Qb(),b.Qb(),b.Rb(26,"div",5),b.Rb(27,"mat-form-field",6),b.Rb(28,"mat-label"),b.yc(29,"Type"),b.Qb(),b.Rb(30,"mat-select",12),b.Rb(31,"mat-option",13),b.yc(32,"Trading"),b.Qb(),b.Rb(33,"mat-option",13),b.yc(34,"Profit And Loss"),b.Qb(),b.Rb(35,"mat-option",13),b.yc(36,"Balance Sheet"),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(37,"div",14),b.Rb(38,"button",15),b.yc(39,"SAVE\xa0"),b.Rb(40,"mat-icon"),b.yc(41,"save"),b.Qb(),b.Qb(),b.Rb(42,"button",16),b.yc(43,"CLOSE"),b.Qb(),b.Qb(),b.Qb()),2&t&&(b.ic("formGroup",e.groupDtlsForm),b.Ab(3),b.Ac("",e.pageMode," - Group"),b.Ab(6),b.Db("flex-space-sm",e.isSmallScrn),b.Ab(1),b.Db("cus-readonly",!e.isCreateMode),b.Ab(3),b.ic("readonly",!e.isCreateMode),b.Ab(1),b.ic("ngIf",e.code.pending),b.Ab(2),b.Ac(" ",e.code.value.length,"/10 "),b.Ab(1),b.ic("ngIf",e.code.hasError("required")||e.code.hasError("alreadyExists")),b.Ab(1),b.Db("flex-space-sm",e.isSmallScrn),b.Ab(6),b.Ac(" ",e.name.value.length,"/50 "),b.Ab(1),b.ic("ngIf",e.name.hasError("required")),b.Ab(1),b.Db("flex-space-sm",e.isSmallScrn),b.Ab(5),b.ic("value",e.groupType.Trading),b.Ab(2),b.ic("value",e.groupType.ProfitAndLoss),b.Ab(2),b.ic("value",e.groupType.BalanceSheet),b.Ab(3),b.ic("disabled",!e.groupDtlsForm.valid||e.inProgress))},directives:[G.x,G.r,G.i,_.h,_.d,f.a,v.a,_.e,h.c,h.g,g.a,G.c,G.q,G.h,G.l,G.v,i.l,h.f,V.a,Y.i,_.c,$.b,h.i,h.b],styles:[""],changeDetection:0}),t})(),Z=(()=>{class t{constructor(t,e,r){this.dialog=t,this.route=e,this.router=r}ngOnInit(){this.route.snapshot.data.pageMode===U.a.PAGE_MODE.CREATE?this.openCreateDialog():this.openEditDialog()}openCreateDialog(){this.dialog.open(W,{width:"550px",role:"dialog",hasBackdrop:!0,disableClose:!0,restoreFocus:!1,data:{pageMode:U.a.PAGE_MODE.CREATE}}).afterClosed().subscribe(t=>{this.router.navigate([{outlets:{dialog:null}}])})}openEditDialog(){this.dialog.open(W,{width:"550px",role:"dialog",hasBackdrop:!0,disableClose:!0,restoreFocus:!1,data:{pageMode:U.a.PAGE_MODE.EDIT,details:this.route.snapshot.data.details}}).afterClosed().subscribe(t=>{this.router.navigate([{outlets:{dialog:null}}])})}}return t.\u0275fac=function(e){return new(e||t)(b.Lb(_.b),b.Lb(o.a),b.Lb(o.b))},t.\u0275cmp=b.Fb({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();const tt=[{path:"list",canActivate:[a.a],component:I},{path:"create",canActivate:[a.a],data:{pageMode:U.a.PAGE_MODE.CREATE},component:Z},{path:"edit/:id",canActivate:[a.a],data:{pageMode:U.a.PAGE_MODE.EDIT},component:Z,resolve:{details:(()=>{class t{constructor(t){this.grpSrvc=t}resolve(t,e){const r=t.paramMap.get("id");return this.grpSrvc.get(r).pipe(Object(B.a)(()=>Object(j.a)(null)))}}return t.\u0275fac=function(e){return new(e||t)(b.Vb(z.g))},t.\u0275prov=b.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}];let et=(()=>{class t{}return t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({factory:function(e){return new(e||t)},imports:[[o.d.forChild(tt)],o.d]}),t})();var rt=r("1+r1");let it=(()=>{class t{}return t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({factory:function(e){return new(e||t)},imports:[[i.c,G.u,rt.a,et]]}),t})()}}]);